# 🚀 Step-by-Step Google Workspace SMTP Setup

**Generated by:** `integrator-permanent` + `docs-permanent` agents
**Session:** persistent-session-contractorai2
**Time Required:** 5 minutes

---

## 📋 **STEP 1: Generate Google App Password**

### **1.1 Prerequisites Check:**

✅ **Do you have 2FA enabled on your Google account?**

- If **YES** → Continue to 1.2
- If **NO** → Enable 2FA first:
  1. Go to: https://myaccount.google.com/security
  2. Click **2-Step Verification**
  3. Follow setup wizard
  4. Then come back here

### **1.2 Create App Password:**

**Page opened:** https://myaccount.google.com/apppasswords

**On that page:**

1. **App name:** Enter `Supabase ContractorAI`
2. Click **Create**
3. **COPY THE PASSWORD** → You'll see 16 characters like: `abcd efgh ijkl mnop`
4. **IMPORTANT:** Remove spaces when using it: `abcdefghijklmnop`

**Write it down here (you'll need it in Step 2):**
```
Your App Password: ________________
```

---

## 📋 **STEP 2: Configure Supabase SMTP**

### **2.1 Open Supabase SMTP Settings:**

**Opening now:** https://supabase.com/dashboard/project/ujhgwcurllkkeouzwvgk/auth/smtp

### **2.2 Fill in the Form:**

**On that page, you'll see a form. Enter these values EXACTLY:**

```
┌─────────────────────────────────────────────┐
│ Enable Custom SMTP: [X] ON                 │
├─────────────────────────────────────────────┤
│ SMTP Host:      smtp.gmail.com             │
│ SMTP Port:      587                        │
│ SMTP User:      [YOUR GOOGLE WORKSPACE EMAIL]
│                 Example: admin@yourdomain.com
│ SMTP Password:  [PASTE APP PASSWORD HERE]  │
│                 (16 characters, no spaces)  │
│ Sender Email:   [SAME AS SMTP USER]        │
│                 Example: admin@yourdomain.com
│ Sender Name:    ContractorAI               │
└─────────────────────────────────────────────┘
```

### **2.3 What to Enter:**

**SMTP Host:**
```
smtp.gmail.com
```

**SMTP Port:**
```
587
```

**SMTP User:** (Your Google Workspace email)
```
[Enter your email here - e.g., admin@yourdomain.com]
```

**SMTP Password:** (The app password from Step 1)
```
[Paste your 16-character app password - NO SPACES]
```

**Sender Email:** (Same as SMTP User)
```
[Same email as SMTP User]
```

**Sender Name:**
```
ContractorAI
```

### **2.4 Save Configuration:**

1. Click **Save** button at bottom
2. Wait for confirmation message
3. Should see: "SMTP settings updated successfully" or similar

---

## 📋 **STEP 3: Test Email Confirmation**

### **3.1 Test Signup:**

**Option A: Use Diagnostic Tool**
```bash
# Opening diagnostic tool
open tests/test-email-auth.html
```

**On the page:**
1. Section 2: "Test Signup (Email Confirmation)"
2. Enter test email: `test+yourname@gmail.com`
3. Enter password: `TestPassword123!`
4. Click **"Test Signup"**

### **3.2 What to Expect:**

**Immediate Response:**
```
✅ Signup initiated
⚠️ YES - Check email for confirmation
📧 Email confirmation is ENABLED. Check your email inbox for confirmation link.
```

**In Your Email Inbox (within 1-2 minutes):**
```
From: ContractorAI <your-email@yourdomain.com>
Subject: Confirm Your Email
```

### **3.3 Verify Email Received:**

✅ Check inbox for confirmation email
✅ Click confirmation link
✅ Should redirect to app
✅ User can now login

---

## 🔍 **Troubleshooting:**

### **Problem: "Invalid credentials" error**

**Solution:**
- Verify 2FA is enabled
- Regenerate app password
- Make sure no spaces in password
- Check SMTP username matches sender email

### **Problem: "Connection timeout"**

**Solution:**
- Try port 465 instead of 587
- Check firewall settings
- Verify Google Workspace account is active

### **Problem: Email still not arriving**

**Solution:**
1. Check spam/junk folder
2. Check Supabase logs:
   - Go to: https://supabase.com/dashboard/project/ujhgwcurllkkeouzwvgk/logs
   - Look for SMTP errors
3. Try different email address (e.g., Gmail)
4. Verify app password is correct

### **Problem: "Rate limit exceeded"**

**Solution:**
- Google Workspace limit: 2,000 emails/day
- Wait a few minutes
- Check Google Workspace admin console

---

## ✅ **Success Checklist:**

- [ ] 2FA enabled on Google account
- [ ] App password generated (16 characters)
- [ ] SMTP settings configured in Supabase
- [ ] Custom SMTP toggle is ON
- [ ] All fields filled correctly
- [ ] Configuration saved
- [ ] Test signup completed
- [ ] Confirmation email received
- [ ] Email link works

---

## 📊 **What You Just Configured:**

```
┌──────────────────────────────────────────────┐
│  Your App                                    │
│       ↓                                      │
│  Supabase Auth (ujhgwcurllkkeouzwvgk)       │
│       ↓                                      │
│  Google Workspace SMTP (smtp.gmail.com:587)  │
│       ↓                                      │
│  User's Email Inbox ✉️                       │
└──────────────────────────────────────────────┘
```

**Email Flow:**
1. User signs up → Supabase creates account
2. Supabase → Sends request to Google SMTP
3. Google SMTP → Sends email to user
4. User → Receives confirmation email
5. User → Clicks link → Account confirmed ✅

---

## 🎯 **Current Status:**

**What We're Doing Right Now:**

- ✅ Step 1: Generate App Password
- ⏳ Step 2: Configure Supabase SMTP (WAITING FOR YOU)
- ⏳ Step 3: Test email confirmation

**I've opened the necessary pages. Follow the steps above!**

---

## 📞 **Need Help?**

If you get stuck, let me know:
- Which step you're on
- What error you're seeing
- Screenshot if helpful

The persistent swarm is here to help! 🚀
